pipeline {
    agent any

    

    environment {
        AWS_REGION = "eu-central-1"
        AWS_CREDENTIALS = "jenkins-aws"
        BUCKET_NAME = "www-bucket-test"
        //BUCKET_ACL = "PublicRead'"

        // This can be http or https
        NEXUS_PROTOCOL = "https"
        // Where your Nexus is running
        NEXUS_URL = "nexus.n00dns.co"
        // Repository where we will upload the artifact
        NEXUS_REPOSITORY = "${NEXUS_REPOSITORY}"
        // Jenkins credential id to authenticate to Nexus OSS
        NEXUS_CREDENTIAL_ID = "jenkins_nexus"
        // Version of package
        //PACKAGE_VERSION = "${PACKAGE_VERSION}"
        //ARTIFACT_VERSION = "${BUILD_NUMBER}"
        BUILD_PATH = "home/ec2-user/workspace/react_app/build"
    }

    stages {
        stage("Download artifact") {
            steps {
                sh "curl -u ${NEXUS_CREDENTIALS_ID}:${NEXUS_CREDENTIALS_ID} -O '${NEXUS_PROTOCOL}://${NEXUS_URL}/repository/react-app/jenkins/react-app/0.0.1/react-app-0.0.1.tgz'"
                sh "tar -xvzf react-app-0.0.1.tgz" 
                sh "cd ${BUILD_PATH}" 
                sh "ls -al "

            }
        }   
        // stage('Upload to AWS') {
        //       steps {
        //           withAWS(region: "${AWS_REGION}",credentials:"${AWS_CREDENTIALS}") {
        //           sh 'echo "Uploading content with AWS creds"'
        //               s3Upload(pathStyleAccessEnabled: true, payloadSigningEnabled: true, file:"README.md", bucket:"${BUCKET_NAME}")
        //           }
        //       }
        //  }
     }
}